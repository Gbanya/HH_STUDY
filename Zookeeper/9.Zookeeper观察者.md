## Zookeeper观察者

#### 概述

1. 对于当前的Zookeeper架构而言，如果添加了更多的投票成员，则会导致写入性能下降：一个写入操作要求共识协议至少是整体的一半，因此投票的成本随着投票者越多会显著增加
2. 在Zookeeper中引入了一个新的Zookeeper节点类型叫做observer（观察者），它帮助处理这个问题并进一步完善了Zookeeper的可扩展性
3.  观察者不参与投票，它只监听投票的结果，但是观察者可以和follower一样运行，即客户端可能链接他们并发送读取和写入请求。 观察者像follower一样转发这些请求到领导者，而他们只是简单的等待监听投票的结果
4. 观察者的数量的多少不影响投票的性能。因此观察者不是Zookeeper集群整体的主要组件。因此如果观察者产生故障或者从集群断开连接都不会影响Zookeeper服务的可用性
5. 在实际使用中，观察者可以连接到比follower更不可靠的网络。事实上，观察者可以用于从其他数据中心和Zookeeper服务通信。观察者的客户端会看到快速的读取，因为所有的读取都在本地，并且写入导致最小的网络开销，因为投票协议所需的消息数量更小

#### 配置

1. 进入到Zookeeper安装目录下的conf目录：cd zookeeper-3.4.8/conf

2. 编辑zoo.cfg文件：vim zoo.cfg

3. 在zoo.cfg中添加如下属性：peerType=observer

4. 在要配置为观察者的主机后添加观察者标记。例如：

   ```properties
   server.1=10.8.42.133:2888:3888
   server.2=10.8.42.134:2888:3888
   server.3=10.8.42.135:2888:3888:observer #表示将该节点设置为观察者
   ```

5. 保存退出文件

6. 进入到Zookeeper的bin目录下启动该服务器端<br/>cd     ../bin<br/>sh zkServer.sh start